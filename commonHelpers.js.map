{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst searchInput = document.querySelector('input');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet searchTerm = '';\nlet page = 1;\nlet totalHits = 0;\n\nlet galleryItemHeight = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionSelector: 'img',\n  captionDelay: 250,\n});\n\nfunction showLoader() {\n  const loader = document.createElement('span');\n  loader.classList.add('loader');\n  loadMoreBtn.parentNode.insertBefore(loader, loadMoreBtn.nextSibling);\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  }\n}\n\nfunction showLoadMoreButton() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  searchTerm = searchInput.value.trim();\n  if (searchTerm === '') {\n    iziToast.error({\n      message: 'Your request is missing. Please fill out the form',\n      position: 'topCenter',\n    });\n    return;\n  }\n\n  gallery.innerHTML = '';\n\n  showLoader();\n\n  try {\n    await searchImages();\n  } catch (error) {\n    iziToast.error({\n      message: `An error occurred: ${error.message}`,\n      position: 'topCenter',\n    });\n  } finally {\n    hideLoader();\n  }\n  searchInput.value = '';\n});\n\nasync function searchImages() {\n  const apiKey = '42356211-e192fc2ea90e5ac732e43fabf';\n  const perPage = 15;\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${searchTerm}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n\n    if (!response.data.hits || response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topCenter',\n      });\n    } else {\n      totalHits = response.data.totalHits;\n      displayImages(response.data);\n      if (gallery.querySelectorAll('.gallery-item').length < totalHits) {\n        showLoadMoreButton();\n        smoothScroll();\n      } else {\n        hideLoadMoreButton();\n        smoothScroll();\n        iziToast.info({\n          message: `We're sorry, but you've reached the end of search results.`,\n          position: 'topCenter',\n        });\n      }\n    }\n  } catch (error) {\n    throw new Error('Failed to fetch images from the server');\n  }\n}\n\nfunction displayImages(data) {\n  const markup = data.hits\n    .map(image => {\n      return `\n      <li class=\"gallery-item\">\n        <a href=\"${image.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n        </a>\n        <p><b>Likes: </b>${image.likes}</p>\n        <p><b>Views: </b>${image.views}</p>\n        <p><b>Comments: </b>${image.comments}</p>\n        <p><b>Downloads: </b>${image.downloads}</p>\n      </li>`;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (galleryItemHeight === 0) {\n    const firstGalleryItem = gallery.querySelector('.gallery-item');\n    if (firstGalleryItem) {\n      const { height } = firstGalleryItem.getBoundingClientRect();\n      galleryItemHeight = height;\n    }\n  }\n\n  lightbox.refresh();\n}\n\nfunction smoothScroll() {\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  page++;\n  showLoader();\n\n  try {\n    await searchImages();\n  } catch (error) {\n    iziToast.error({\n      message: `An error occurred: ${error.message}`,\n      position: 'topCenter',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["form","gallery","searchInput","loadMoreBtn","searchTerm","page","totalHits","galleryItemHeight","lightbox","SimpleLightbox","showLoader","loader","hideLoader","showLoadMoreButton","hideLoadMoreButton","event","iziToast","searchImages","error","url","response","axios","displayImages","smoothScroll","data","markup","image","firstGalleryItem","height"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,OAAO,EAC5CC,EAAc,SAAS,cAAc,YAAY,EACvD,IAAIC,EAAa,GACbC,EAAO,EACPC,EAAY,EAEZC,EAAoB,EAExB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,SAAU,GACV,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,gBAAiB,MACjB,aAAc,GAChB,CAAC,EAED,SAASC,GAAa,CACpB,MAAMC,EAAS,SAAS,cAAc,MAAM,EAC5CA,EAAO,UAAU,IAAI,QAAQ,EAC7BR,EAAY,WAAW,aAAaQ,EAAQR,EAAY,WAAW,CACrE,CAEA,SAASS,GAAa,CACpB,MAAMD,EAAS,SAAS,cAAc,SAAS,EAC3CA,GACFA,EAAO,OAAM,CAEjB,CAEA,SAASE,GAAqB,CAC5BV,EAAY,MAAM,QAAU,OAC9B,CAEA,SAASW,GAAqB,CAC5BX,EAAY,MAAM,QAAU,MAC9B,CAEAH,EAAK,iBAAiB,SAAU,MAAMe,GAAS,CAG7C,GAFAA,EAAM,eAAc,EACpBX,EAAaF,EAAY,MAAM,OAC3BE,IAAe,GAAI,CACrBY,EAAS,MAAM,CACb,QAAS,oDACT,SAAU,WAChB,CAAK,EACD,MACD,CAEDf,EAAQ,UAAY,GAEpBS,IAEA,GAAI,CACF,MAAMO,EAAY,CACnB,OAAQC,EAAO,CACdF,EAAS,MAAM,CACb,QAAS,sBAAsBE,EAAM,OAAO,GAC5C,SAAU,WAChB,CAAK,CACL,QAAY,CACRN,GACD,CACDV,EAAY,MAAQ,EACtB,CAAC,EAED,eAAee,GAAe,CAG5B,MAAME,EAAM,qEAA4Cf,CAAU,iEAAiEC,CAAI,eAEvI,GAAI,CACF,MAAMe,EAAW,MAAMC,EAAM,IAAIF,CAAG,EAEhC,CAACC,EAAS,KAAK,MAAQA,EAAS,KAAK,KAAK,SAAW,EACvDJ,EAAS,MAAM,CACb,QACE,2EACF,SAAU,WAClB,CAAO,GAEDV,EAAYc,EAAS,KAAK,UAC1BE,EAAcF,EAAS,IAAI,EACvBnB,EAAQ,iBAAiB,eAAe,EAAE,OAASK,GACrDO,IACAU,MAEAT,IACAS,IACAP,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACpB,CAAS,GAGN,MAAe,CACd,MAAM,IAAI,MAAM,wCAAwC,CACzD,CACH,CAEA,SAASM,EAAcE,EAAM,CAC3B,MAAMC,EAASD,EAAK,KACjB,IAAIE,GACI;AAAA;AAAA,mBAEMA,EAAM,aAAa;AAAA,4CACMA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,2BAEvDA,EAAM,KAAK;AAAA,2BACXA,EAAM,KAAK;AAAA,8BACRA,EAAM,QAAQ;AAAA,+BACbA,EAAM,SAAS;AAAA,YAEzC,EACA,KAAK,EAAE,EAIV,GAFAzB,EAAQ,mBAAmB,YAAawB,CAAM,EAE1ClB,IAAsB,EAAG,CAC3B,MAAMoB,EAAmB1B,EAAQ,cAAc,eAAe,EAC9D,GAAI0B,EAAkB,CACpB,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAiB,sBAAqB,EACzDpB,EAAoBqB,CACrB,CACF,CAEDpB,EAAS,QAAO,CAClB,CAEA,SAASe,GAAe,CACtB,OAAO,SAAS,CACd,IAAKhB,EAAoB,EACzB,SAAU,QACd,CAAG,CACH,CAEAJ,EAAY,iBAAiB,QAAS,SAAY,CAChDE,IACAK,IAEA,GAAI,CACF,MAAMO,EAAY,CACnB,OAAQC,EAAO,CACdF,EAAS,MAAM,CACb,QAAS,sBAAsBE,EAAM,OAAO,GAC5C,SAAU,WAChB,CAAK,CACL,QAAY,CACRN,GACD,CACH,CAAC"}